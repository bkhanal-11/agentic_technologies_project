<svg viewBox="0 0 1850 1000" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="1850" height="1000" fill="#f8f9fa"/>
  
  <!-- Researcher Agent - Left-Center with more spacing -->
  <polygon points="250,150 350,100 450,150 450,250 350,300 250,250" fill="#a7c7e7" stroke="#6699cc" stroke-width="3" filter="url(#drop-shadow)"/>
  <text x="350" y="205" font-family="Arial, sans-serif" font-size="26" font-weight="bold" text-anchor="middle">Researcher</text>
  <text x="350" y="245" font-family="Arial, sans-serif" font-size="26" font-weight="bold" text-anchor="middle">Agent</text>

  <!-- Knowledge Aggregator Agent - Right-Top with more spacing -->
  <polygon points="950,150 1050,100 1150,150 1150,250 1050,300 950,250" fill="#a7c7e7" stroke="#6699cc" stroke-width="3" filter="url(#drop-shadow)"/>
  <text x="1050" y="190" font-family="Arial, sans-serif" font-size="26" font-weight="bold" text-anchor="middle">Knowledge</text>
  <text x="1050" y="230" font-family="Arial, sans-serif" font-size="26" font-weight="bold" text-anchor="middle">Aggregator</text>
  <text x="1050" y="270" font-family="Arial, sans-serif" font-size="26" font-weight="bold" text-anchor="middle">Agent</text>
  
  <!-- Query Construction Agent - Left-Bottom with more spacing -->
  <polygon points="200,450 300,400 400,450 400,550 300,600 200,550" fill="#a7c7e7" stroke="#6699cc" stroke-width="3" filter="url(#drop-shadow)"/>
  <text x="300" y="465" font-family="Arial, sans-serif" font-size="26" font-weight="bold" text-anchor="middle">Query</text>
  <text x="300" y="505" font-family="Arial, sans-serif" font-size="26" font-weight="bold" text-anchor="middle">Construction</text>
  <text x="300" y="545" font-family="Arial, sans-serif" font-size="26" font-weight="bold" text-anchor="middle">Agent</text>
  
  <!-- Relevant Methods Extractor - Right-Mid with more spacing -->
  <polygon points="950,450 1050,400 1150,450 1150,550 1050,600 950,550" fill="#a7c7e7" stroke="#6699cc" stroke-width="3" filter="url(#drop-shadow)"/>
  <text x="1050" y="455" font-family="Arial, sans-serif" font-size="26" font-weight="bold" text-anchor="middle">Relevant</text>
  <text x="1050" y="495" font-family="Arial, sans-serif" font-size="26" font-weight="bold" text-anchor="middle">Methods</text>
  <text x="1050" y="535" font-family="Arial, sans-serif" font-size="26" font-weight="bold" text-anchor="middle">Extractor</text>
  <text x="1050" y="575" font-family="Arial, sans-serif" font-size="26" font-weight="bold" text-anchor="middle">Agent</text>
  
  <!-- Search Agent - Center-Bottom with more spacing -->
  <polygon points="500,650 600,600 700,650 700,750 600,800 500,750" fill="#a7c7e7" stroke="#6699cc" stroke-width="3" filter="url(#drop-shadow)"/>
  <text x="600" y="685" font-family="Arial, sans-serif" font-size="26" font-weight="bold" text-anchor="middle">Search</text>
  <text x="600" y="725" font-family="Arial, sans-serif" font-size="26" font-weight="bold" text-anchor="middle">Agent</text>
  
  <!-- Search Services - Bottom-Right with more spacing -->
  <rect x="950" y="700" width="300" height="140" rx="20" ry="20" fill="#d4e6f1" stroke="#5dade2" stroke-width="3" filter="url(#drop-shadow)"/>
  <text x="1100" y="750" font-family="Arial, sans-serif" font-size="26" font-weight="bold" text-anchor="middle">Search</text>
  <text x="1100" y="790" font-family="Arial, sans-serif" font-size="26" font-weight="bold" text-anchor="middle">Services</text>
  
  <!-- Knowledge Base - New Element with increased spacing -->
  <rect x="1450" y="150" width="300" height="140" rx="20" ry="20" fill="#d4e6f1" stroke="#5dade2" stroke-width="3" filter="url(#drop-shadow)"/>
  <text x="1600" y="200" font-family="Arial, sans-serif" font-size="26" font-weight="bold" text-anchor="middle">Knowledge</text>
  <text x="1600" y="240" font-family="Arial, sans-serif" font-size="26" font-weight="bold" text-anchor="middle">Base</text>

  <!-- Styles for drop shadow and arrowheads -->
  <defs>
    <filter id="drop-shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feGaussianBlur in="SourceAlpha" stdDeviation="3"/>
      <feOffset dx="2" dy="2" result="offsetblur"/>
      <feComponentTransfer>
        <feFuncA type="linear" slope="0.2"/>
      </feComponentTransfer>
      <feMerge> 
        <feMergeNode/>
        <feMergeNode in="SourceGraphic"/> 
      </feMerge>
    </filter>
  </defs>
  
  <!-- Knowledge Aggregator to Researcher Agent - REMOVED -->
  
  <!-- Knowledge Aggregator to Knowledge Base with increased spacing -->
  <g>
    <path d="M1150 180 L1450 180" stroke="#555" stroke-width="3.5" fill="none"/>
    <polygon points="1450,180 1435,170 1435,190" fill="#555"/>
    <!-- Rotated text - horizontal now -->
    <text transform="translate(1300, 155)" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" fill="#555">Structured Knowledge</text>
  </g>
  
  <!-- Knowledge Base to Knowledge Aggregator with increased spacing -->
  <g>
    <path d="M1450 230 L1150 230" stroke="#555" stroke-width="3.5" fill="none" stroke-dasharray="7,7"/>
    <polygon points="1150,230 1165,240 1165,220" fill="#555"/>
    <!-- Rotated text - horizontal now -->
    <text transform="translate(1300, 265)" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" fill="#555">Context &amp; References</text>
  </g>
  
  <!-- Researcher Agent to Query Construction Agent -->
  <g>
    <path d="M350 300 C340,350 330,380 300 400" stroke="#555" stroke-width="3.5" fill="none"/>
    <polygon points="290,400 313,410 310,390" fill="#555"/>
    <!-- Rotated text: follows curve down -->
    <text transform="translate(415, 350) rotate(-60)" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" fill="#555">Research Intent</text>
  </g>
  
  <!-- Query Construction Agent to Search Agent -->
  <g>
    <path d="M400 500 C450,550 490,600 500 650" stroke="#555" stroke-width="3.5" fill="none"/>
    <polygon points="500,650 514,640 494,635" fill="#555"/>
    <!-- Rotated text: FIXED - follows curved path better -->
    <text transform="translate(475, 550) rotate(50)" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" fill="#555">Structured Queries</text>
  </g>
  
  <!-- Search Agent to Search Services -->
  <g>
    <path d="M700 700 L950 730" stroke="#555" stroke-width="3.5" fill="none"/>
    <polygon points="950,730 935,718 935,742" fill="#555"/>
    <!-- Rotated text: slight downward angle -->
    <text transform="translate(820, 700) rotate(5)" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" fill="#555">Execute Queries</text>
  </g>
  
  <!-- Search Services to Search Agent -->
  <g>
    <path d="M950 750 L700 720" stroke="#555" stroke-width="3.5" fill="none"/>
    <polygon points="700,720 715,732 715,708" fill="#555"/>
    <!-- Rotated text: slight upward angle -->
    <text transform="translate(820, 765) rotate(5)" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" fill="#555">Results</text>
  </g>
  
  <!-- Search Agent to Relevant Methods Extractor -->
  <g>
    <path d="M700 650 C775,610 850,570 950 550" stroke="#555" stroke-width="3.5" fill="none"/>
    <polygon points="950,550 935,538 935,562" fill="#555"/>
    <!-- Rotated text: FIXED - follows curve better -->
    <text transform="translate(820, 625) rotate(-25)" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" fill="#555">Search Results</text>
  </g>
  
  <!-- Relevant Methods Extractor to Search Agent (feedback) -->
  <g>
    <path d="M950 500 C850,550 775,600 700 650" stroke="#555" stroke-width="3.5" fill="none" stroke-dasharray="7,7"/>
    <polygon points="700,650 715,662 715,638" fill="#555"/>
    <!-- Rotated text: FIXED - follows curved path better -->
    <text transform="translate(820, 550) rotate(-30)" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" fill="#555">Refined Queries</text>
  </g>
  
  <!-- Relevant Methods Extractor to Knowledge Aggregator -->
  <g>
    <path d="M1050 400 C1050,350 1050,310 1050 300" stroke="#555" stroke-width="3.5" fill="none"/>
    <polygon points="1050,300 1040,315 1060,315" fill="#555"/>
    <!-- Rotated text: as in your manual fix -->
    <text transform="translate(1165, 350) rotate(0)" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" fill="#555">Researched Content</text>
  </g>
  
  <!-- Legend - repositioned and increased height -->
  <rect x="1450" y="350" width="350" height="300" rx="15" ry="15" fill="white" stroke="#ddd" stroke-width="3"/>
  <text x="1600" y="390" font-family="Arial, sans-serif" font-size="28" font-weight="bold" text-anchor="middle">Legend</text>
  
  <!-- Legend items - larger -->
  <polygon points="1480,420 1520,400 1560,420 1560,455 1520,475 1480,455" fill="#a7c7e7" stroke="#6699cc" stroke-width="3"/>
  <text x="1610" y="440" font-family="Arial, sans-serif" font-size="22" font-weight="bold" text-anchor="middle">Agent</text>
  
  <rect x="1480" y="495" width="80" height="50" rx="8" ry="8" fill="#d4e6f1" stroke="#5dade2" stroke-width="3"/>
  <text x="1660" y="530" font-family="Arial, sans-serif" font-size="22" font-weight="bold" text-anchor="middle">External Service</text>
  
  <!-- Legend arrows with manually drawn larger arrowheads -->
  <g>
    <path d="M1480 565 L1550 565" stroke="#555" stroke-width="3.5" fill="none"/>
    <polygon points="1550,565 1535,555 1535,575" fill="#555"/>
    <text x="1630" y="570" font-family="Arial, sans-serif" font-size="22" font-weight="bold" text-anchor="middle">Data Flow</text>
  </g>

  <g>
    <path d="M1480 610 L1550 610" stroke="#555" stroke-width="3.5" fill="none" stroke-dasharray="7,7"/>
    <polygon points="1550,610 1535,600 1535,620" fill="#555"/>
    <text x="1660" y="615" font-family="Arial, sans-serif" font-size="22" font-weight="bold" text-anchor="middle">Feedback Loop</text>
  </g>
</svg>